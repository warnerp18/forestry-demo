import progress from '../components/progress';

describe('Progress component in styleguide', () => {
  beforeEach(() => {
    const fixture = `
      <div class="progress">
        <div class="progress__activity"></div>
      </div>

      <input type="number" value="50" data-js-progress-percentage/>
    `;

    document.body.innerHTML = fixture;
    progress();
  });

  describe('when changing the value of the progress percentage', () => {
    let progressPercentage;
    let changeEvent;

    beforeEach(() => {
      progressPercentage = document.querySelector('[data-js-progress-percentage]');
      changeEvent = new Event('keyup');

      progressPercentage.value = '56';
      progressPercentage.dispatchEvent(changeEvent);
    });

    it('updates the width of progress activity to be the value of progress percentage', () => {
      const progressActivity = document.querySelector('.progress__activity');

      expect(progressActivity.style.width).toEqual('56%');
    });

    describe('and when the value reaches 100% or over', () => {
      beforeEach(() => {
        progressPercentage.value = '100';
        progressPercentage.dispatchEvent(changeEvent);
      });

      it('should add the is-complete class to the progress element', () => {
        const progressContainer = document.querySelector('.progress');

        expect(progressContainer.classList.contains('is-complete')).toEqual(true);
      });
    });
  });
});
