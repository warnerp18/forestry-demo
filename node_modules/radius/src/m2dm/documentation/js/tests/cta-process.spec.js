import ctaProcess from '../components/cta-process';

describe('CTA processing component in styleguide', () => {
  let btn1;
  let btn2;

  const CLASS_PROCESSING = 'is-processing';

  beforeEach(() => {
    const fixture = `
      <button id="btn1" class="cta-primary--process">Click me</button>
      <button id="btn2" class="cta-primary--process">Click me</button>
    `;

    document.body.innerHTML = fixture;

    btn1 = document.querySelector('#btn1');
    btn2 = document.querySelector('#btn2');

    ctaProcess();
  });

  describe('the button does not have the `is-processing` class', () => {
    beforeEach(() => {
      btn1.classList.remove(CLASS_PROCESSING);
      btn2.classList.remove(CLASS_PROCESSING);
    });

    describe('when clicking the button', () => {
      beforeEach(() => {
        btn1.click();
      });

      it('adds the `is-processing` class', () => {
        expect(btn1.classList.contains(CLASS_PROCESSING)).toBe(true);
      });
    });

    describe('it works with multiple elements', () => {
      describe('when clicking the 2nd button', () => {
        beforeEach(() => {
          btn2.click();
        });

        it('does not add the `is-processing` class on the 1st element', () => {
          expect(btn1.classList.contains(CLASS_PROCESSING)).toBe(false);
        });

        it('adds the `is-processing` class on the 2nd element', () => {
          expect(btn2.classList.contains(CLASS_PROCESSING)).toBe(true);
        });
      });
    });
  });

  describe('the button has the `is-processing` class', () => {
    beforeEach(() => {
      btn1.classList.add(CLASS_PROCESSING);
      btn2.classList.add(CLASS_PROCESSING);
    });

    describe('when clicking the button', () => {
      beforeEach(() => {
        btn1.click();
      });

      it('removes the `is-processing` class', () => {
        expect(btn1.classList.contains(CLASS_PROCESSING)).toBe(false);
      });
    });

    describe('it works with multiple elements', () => {
      describe('when clicking the 2nd button', () => {
        beforeEach(() => {
          btn2.click();
        });

        it('does not remove the `is-processing` class on the 1st element', () => {
          expect(btn1.classList.contains(CLASS_PROCESSING)).toBe(true);
        });

        it('removes the `is-processing` class on the 2nd element', () => {
          expect(btn2.classList.contains(CLASS_PROCESSING)).toBe(false);
        });
      });
    });
  });
});
