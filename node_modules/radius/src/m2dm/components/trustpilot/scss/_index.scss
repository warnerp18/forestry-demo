/**
 * section: M2DM/components/trust/trustpilot
 * title: Trustpilot
 *
 * activateComponent: radius-component-trustpilot
 * jsModule: trustpilot
 * jsFunction: trustpilot().start
 *
 * purpose: Use to increase credibility and trust based on the visual representation of the Trustpilot logo, rating and reviews.
 *
 * description: |
 *   When paired with Trustpilot quotes, this component offers an opportunity to demonstrate social proof and support claims about our products and service.<br><br>
 *
 *   The TrustPilot component can be used as a standalone section. It can also be paired with other content or contained within other components, eg. it can be paired with a heading or contained within the Hero or Trust block, but it cannot contain any other content. It can live in the context of the `Third Party Block` or inside the `Hero` component.<br><br>
 *
 *   ### Usage

 *   Ensure the component contains the data attribute `data-js-trustpilot-api`.<br><br>
 *
 *   ### API
 *
 *   This component fetches data from the Trustpilot API in order to show the current star rating, trustscore, and number of reviews. To reduce API calls, it stores the API data in localStorage, and only refreshes from the API after one day.<br><br>
 *
 *   ### Variants
 *
 *   `.trustpilot--small` - makes it a bit smaller <br>
 *   `.trustpilot--inverse` - for use on dark background. **make sure you use the inverse trustpilot logo too**<br><br>
 *   `.trustpilot--centered` - centers the content of the component<br><br>
 *
 *   ### Other
 *
 *   The element will automatically be hidden, if the number of stars on Trustpilot is 3 or less. This is so if there is a dramatic drop in the Trustpilot score, at least it won't be advertised on the website.<br><br>
 *
 *   ### Logo
 *
 *   The link for the logo is optional - please remove hyperlink from the example markup if not required.<br><br>
 *
 *   ### Dynamic elements
 *
 *   To use the information returned from the API, there are 4 dynamic elements that can be used. These are span tags with data attributes on them. When the trustpilot script runs, these tags will be found and replaced with the correct data.
 *
 *   - `<span data-js-trustpilot-headline-rating data-content-4stars="Great" data-content-5stars="Excellent"></span>` - Displays a word which reflects the current star rating. The word displayed must be provided as a data attribute
 *   - `<span data-js-trustpilot-stars></span>` - Displays images of stars. This element will be filled with either 4 or 5 image tags, depending on the current star rating.
 *   - `<span data-js-trustpilot-trustscore></span>` - Displays the current trustscore
 *   - `<span data-js-trustpilot-review-count></span>` - Displays the current number of reviews written
 *
 * layout: components/trustpilot/example
 *
 * markup: components/trustpilot/example-markup
 */


@mixin radius-component-trustpilot {
  $trustpilot-green: #00b67a;

  .trustpilot {
    opacity: 0;

    transition: opacity 0.5s;
  }


  .trustpilot.is-visible {
    opacity: 1;
  }


  .trustpilot__row {
    display: flex;
    align-items: center;
    flex-wrap: wrap;
  }


  .trustpilot__star-group {
    display: flex;
    margin-bottom: 0.5rem;
  }


  .trustpilot__star {
    width: 1.25rem;
    height: 1.25rem;

    background-image: url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjxwYXRoIGZpbGw9IiMwMEI2N0EiIGQ9Ik0wIDBoMjB2MjBIMHoiLz48cGF0aCBkPSJNMTAgMTMuMTA0bDMuMDQyLS43NyAxLjI3IDMuOTE2TDEwIDEzLjEwNHptNy01LjA2MmgtNS4zNTRMMTAgMyA4LjM1NCA4LjA0MkgzbDQuMzMzIDMuMTI1LTEuNjQ2IDUuMDQxIDQuMzM0LTMuMTI1IDIuNjY2LTEuOTE2TDE3IDguMDQyeiIgZmlsbD0iI0ZGRiIvPjwvZz48L3N2Zz4=");
    background-position: bottom left;
    background-repeat: no-repeat;
    background-size: contain;
  }


  .trustpilot__star:not(:last-child) {
    margin-right: 0.125rem;
  }


  .trustpilot__headline-rating {
    @include font(x-large);

    margin-right: 0.5rem;

    font-family: get-config(font-family-primary);
    font-weight: bold;
    color: $trustpilot-green;
  }


  .trustpilot__tp-logo {
    width: 6rem;
  }


  .trustpilot__reviews-summary {
    margin-bottom: 0;
  }


  .trustpilot__review-count {
    color: get-color(grey, light);
  }


  .trustpilot__review-count--with-divider {
    position: relative;

    padding-left: 0.5rem;
    margin-left: 0.5rem;


    &::before {
      position: absolute;
      top: 50%;
      left: 0;

      display: block;

      width: 0.0625rem;
      height: 1rem;

      background: get-color(grey, x-light);

      content: "";

      transform: translateY(-50%);
    }
  }


  .trustpilot:not(.trustpilot--small) .trustpilot__reviews-summary + .trustpilot__tp-logo {
    width: 7rem;
  }


  // Small variant
  .trustpilot--small {
    .trustpilot__star-group {
      margin-bottom: 0.3rem;
    }


    .trustpilot__star {
      width: 1rem;
      height: 1rem;
    }


    .trustpilot__headline-rating {
      @include font(large);
    }


    .trustpilot__tp-logo {
      width: 5rem;
    }


    .trustpilot__review-count {
      text-transform: uppercase;
    }


    .trustpilot__reviews-summary,
    .trustpilot__review-count {
      @include font(small);
    }
  }


  // Inverse variant
  .trustpilot--inverse {
    .trustpilot__reviews-summary,
    .trustpilot__review-count {
      color: get-color(grey, 3x-light);
    }


    .trustpilot__headline-rating {
      color: get-color(white);
    }
  }


  .trustpilot--centered {
    .trustpilot__row {
      justify-content: center;
    }


    .trustpilot__headline-rating,
    .trustpilot__star-group {
      margin-right: 0.25rem;
      margin-left: 0.25rem;
    }
  }
}
