/**
 * section: M2DM/components/header
 * title: Header
 *
 * activateComponent: radius-component-header
 * jsModule: header
 *
 * abstractLink: dcaec04e-53b0-4b0f-bd98-6314c0370a39
 *
 * purpose: Use to easily explore and switch between top-level pages in a single interaction.
 *
 * description: |
 *   Header containing 3 levels of navigation and an overlay that holds additional navigation links.<br><br>
 *   1) `.header__upper` - contains the geo locator, contact number (and opening times in some regions), and sign in link on larger screens. On smaller screens this section contains the logo, call us icon and copy and a sign in link.<br>
 *
 *   2) `.header__primary` - contains the logo on larger screen sizes (the logo is removed on smaller screens), a primary nav bar that has horizontal scrolling enabled and a menu icon, which opens the header overlay on click. The content in the overlay is contained within the `header-overlay__window`.<br>
 *
 *   3) `.header__secondary` - contains the current page title, as well as a secondary nav bar that has horizontal scrolling enabled<br><br>
 *
 *   ### Class modifiers
 *   - `is-current` - state class used to indicate the current page the user is on.<br>
 *   - `header__nav-link--is-cta` - use on links that are call to actions e.g. check your eligibility.<br>
 *   - `header__border` - optional class and is only needed when the secondary nav in it's default form (not required on the inverse version of the secondary nav).<br>
 *   - `header-overlay__window--extended` - allows more than 4 columns to be accommodated inside the main area of the overlay.<br>
 * 
 *   ### Dependencies
 *   This component requires the transitionsSupported module to be included:</br />
 *   `import transitionsSupported` from `radius/dist/m2dm/js/transitions-supported`;
 *
 * markup: components/header/example-header
 */

/**
 * section: M2DM/components/header/header-secondary
 * title: Standard secondary navigation
 *
 * description: |
 *    The secondary navigation is optional and contains the current page title, as well as a secondary navigation bar that has horizontal scrolling enabled, so ensure all navigation can be accessed on smaller screens<br><br>
 *    There are 2 variants of the secondary nav:<br>
 *    1) default/standard for use on neutral/light grey background (see example below) - which sits within the normal flow of the page (visible in default header example below)<br>
 *    2) an inverse state for use on a dark background or image [see example](/M2DM/components/header/header-secondary-inverse/).
 *
 * layout: components/header/layout-secondary-nav
 * markup-secondary: components/header/example-secondary
 */

/**
 * section: M2DM/components/header/header-secondary-inverse
 * title: Inverse secondary navigation
 *
 * description: |
 *    The secondary navigation is optional and contains the current page title, as well as a secondary navigation bar that has horizontal scrolling enabled, so ensure all navigation can be accessed on smaller screens.<br><br>
 *    See below for an example of the inverse version of the secondary navigation - for use over a dark solid background or darker image.<br><br>
 *    To  use this apply the `header__secondary--inverse` class to the secondary header navbar (see example markup below). This should be combined with the `header__secondary--fold-over` class, which takes the secondary nav out of the normal page flow and positions it over the content below.
 *
 * layout: components/header/layout-secondary-nav
 * markup-secondary-inverse: components/header/example-secondary
 */


/**
 * section: M2DM/components/header/header-minimal
 * title: Minimal
 *
 * description: |
 *   The purpose of the minimal header is to minimise distractions by removing unnecessary links and content and focuses the user on the critcal path to conversion. It contains 2 levels of navigation only and only critical links.<br>
 *
 * markup: components/header/example-minimal
 */


@import "overlay/index";


@mixin radius-component-header {
  $current-link-color: get-color(orange);
  $active-color: get-color(orange, contrast);
  $border-color: get-color(grey, 2x-light);
  $cta-underline-color: get-color(blue, contrast);
  $cta-underline-height: 0.125rem;
  $horizontal-spacing-unit: 1rem;
  $vertical-spacing-unit: 0.5rem;
  $width-nav-gradient: 1rem;
  $header-height: 3rem;
  $header-height-thin: 2rem;
  $compact-layout: mobile-medium;

  // disable scrolling on the body when the overlay is open. Absolutely MUST NOT be overridden
  .header-overlay-open {
    overflow: hidden !important; // stylelint-disable-line declaration-no-important
  }


  .header {
    @include font(small, false);
    @include z-index(nav, $position: relative);

    line-height: 1.5;


    @include from($compact-layout) {
      @include font(medium, false);
    }
  }


  .header__inner {
    @include page-grid;
  }


  .header__upper,
  .header__navbar,
  .header__nav {
    display: flex;

    align-items: center;
  }


  .header__navbar {
    @include from($compact-layout) {
      margin-right: 1.5rem;
      margin-left: 1.5rem;
    }
  }


  .header__nav {
    margin-left: auto;
  }


  .header__primary .header__nav,
  .header__secondary {
    overflow: hidden;
  }


  .header__upper {
    width: 100%;
    min-height: $header-height;

    background: get-color(white);


    @include to($compact-layout) {
      border-bottom: 1px solid $border-color;
    }


    @include from($compact-layout) {
      min-height: $header-height-thin;

      color: get-color(grey, 2x-light);

      background-color: get-color(grey, contrast);
    }
  }


  .header__border,
  .header__navbar--secondary {
    border-bottom: 1px solid $border-color;
  }


  .header__secondary {
    color: get-color(grey, light);


    @include to($compact-layout) {
      display: none;
    }
  }


  .header__secondary--fold-over {
    position: absolute;
    top: 100%;
    right: 0;
    left: 0;
  }


  .header__nav--controls {
    @include font(small);

    padding-left: 0;
    margin-top: 0;
    margin-bottom: 0;

    list-style: none;
  }


  .header__nav--controls .header__nav-item {
    padding: 0.5rem;


    &:last-child {
      padding-right: 0;
    }
  }


  .header__nav-link {
    display: inline;
    padding: 0;

    background: none;
    border: 0;


    &:not(:first-child) {
      margin-left: $horizontal-spacing-unit;
    }
  }


  .header__primary .header__nav-link,
  .header__secondary .header__nav-link {
    padding-top: $vertical-spacing-unit;
    padding-bottom: $vertical-spacing-unit;
  }


  .header__primary .header__nav-link {
    @include to($compact-layout) {
      line-height: 2;
    }


    @include from($compact-layout) {
      padding-top: $vertical-spacing-unit * 2;
      padding-bottom: $vertical-spacing-unit * 2;
    }
  }


  .header__primary .header__nav--scrollable {
    padding-right: $horizontal-spacing-unit;
  }


  .header__nav-link,
  .header__secondary .header__nav-link,
  .header__nav-item .header__nav-link {
    color: inherit;

    white-space: nowrap;

    cursor: pointer;


    &:hover {
      color: $active-color;
    }
  }


  .header__secondary .header__nav-link {
    @include font(small, false);

    line-height: 2;
  }


  .header__nav-item--compact {
    @include from($compact-layout) {
      display: none;
    }
  }


  .header__nav-item--comfortable {
    @include to($compact-layout) {
      display: none;
    }
  }


  .header__nav-item--comfortable > *,
  .header__nav-item--compact > *,
  .header__nav-link > * {
    vertical-align: middle;
  }


  .header__nav--scrollable {
    -webkit-overflow-scrolling: touch;
    -ms-overflow-style: -ms-autohiding-scrollbar;
    overflow-x: auto;
    overflow-y: hidden;

    white-space: nowrap;


    &::-webkit-scrollbar {
      display: none;
    }
  }


  .header__logo {
    display: block;
    width: 6.25rem;
    padding-top: $vertical-spacing-unit;
    padding-bottom: $vertical-spacing-unit;
  }


  .header__logo img {
    display: block;
    width: 100%;
    padding-right: 0.5rem;

    vertical-align: middle;
  }


  .header__logo--compact {
    width: 5rem;
  }


  .header__logo--compact,
  .header__logo--compact img {
    @include from($compact-layout) {
      display: none;
    }
  }


  .header__logo--comfortable,
  .header__logo--comfortable img {
    min-width: 6.25rem;


    @include to($compact-layout) {
      display: none;
    }
  }


  .header__page-title {
    padding-right: $horizontal-spacing-unit;

    font-weight: bold;
    white-space: nowrap;
  }


  .header__menu-icon::before,
  .header__navbar--secondary::after {
    position: absolute;

    display: none;

    width: $width-nav-gradient;
    height: 100%;

    pointer-events: none;

    background: linear-gradient(to right, rgba(get-color(white), 0.15), rgba(get-color(white), 0.95) 60%);

    content: "";
  }


  .header__menu-icon {
    position: relative;

    vertical-align: middle;
    white-space: nowrap;


    &::before {
      left: $width-nav-gradient * -1;


      @include to(tablet-medium) {
        display: block;
      }
    }
  }


  .header__navbar--secondary {
    position: relative;


    &::after {
      right: 0;


      @include to(tablet-medium) {
        display: block;
      }
    }
  }


  .header__nav-link.is-current {
    box-shadow: inset 0 -0.125rem 0 $current-link-color;


    &:hover {
      box-shadow: inset 0 -0.125rem 0 $active-color;
    }
  }


  .header__secondary .header__nav-link.is-current {
    font-weight: bold;
  }


  .header__nav-link--is-cta {
    &::after {
      display: block;
      height: $cta-underline-height;
      margin-top: $cta-underline-height * -1;

      background-color: $cta-underline-color;

      content: "";
    }


    &:hover::after {
      background-color: $active-color;
    }
  }


  .header__secondary--inverse {
    .header__navbar--secondary::after {
      display: none;
    }


    .header__page-title,
    .header__nav-link:not(:hover) {
      color: get-color(white);
    }


    .header__navbar--secondary {
      border-color: get-color(white);
    }


    .header__nav-link.is-current {
      box-shadow: inset 0 -0.125rem 0 get-color(white);


      &:hover {
        box-shadow: inset 0 -0.125rem 0 $active-color;
      }
    }
  }


  .header-overlay {
    @include z-index(modal, 3);

    position: fixed;

    top: $header-height;
    bottom: 0;
    left: 0;

    width: 100%;


    @include from($compact-layout) {
      top: $header-height-thin;
    }
  }


  .header.is-active .header__upper {
    @include z-index(modal, 5, fixed); // needs to sit on top of the modal header-overlay because of the dropdown

    top: 0;
    left: 0;
  }


  .no-flexbox {
    .header::after,
    .header__navbar::after {
      display: block;
      width: 100%;
      clear: both;

      content: "";
    }


    .header__page-title,
    .header__logo {
      float: left;
    }


    .header__nav {
      float: right;
    }


    .header__navbar {
      width: 100%;
    }


    .header__primary .header__nav {
      display: table;
    }


    .header__nav > * {
      display: table-cell;
    }


    .header__navbar--secondary .header__nav-link {
      display: inline-block;
      margin-left: 1rem;
    }


    .header__page-title,
    .header__nav--scrollable {
      vertical-align: middle;
    }
  }


  // remove once icons PR is merged
  .icon {
    display: inline-block;
    width: 1rem;
    height: 1rem;
    overflow: hidden;
    fill: currentColor;
  }


  .icon--small {
    width: 0.8125rem;
    height: 0.8125rem;
  }
}
