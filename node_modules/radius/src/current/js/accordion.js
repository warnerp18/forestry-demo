import utils from './utils';

const ACTIVE_CLASS = 'is-active';
const SELECTOR = '.js-accordion-item';

export default function accordionComponent() {
  const accordionItems = document.querySelectorAll(SELECTOR);
  const titles = document.querySelectorAll('.js-accordion-item__title');

  utils.forEach(accordionItems, removeActiveClass);
  utils.forEach(titles, createAccordion);

  function removeActiveClass(element) {
    utils.removeClass(element, ACTIVE_CLASS);
  }

  function createAccordion(element) {
    utils.addEventListener(element, 'click', onAccordionItemClick)
  }

  function onAccordionItemClick(event) {
    const element = event.target;
    const accordionItem = element.closest(SELECTOR);
    const activeBeforeClick = utils.hasClass(accordionItem, ACTIVE_CLASS);

    utils.forEach(accordionItems, function(el) {utils.removeClass(el, ACTIVE_CLASS)});

    if (!activeBeforeClick) {
      utils.addClass(accordionItem, ACTIVE_CLASS);
    }
  }
}

