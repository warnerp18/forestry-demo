import utils from './utils';

const GESTURE_THRESHOLD = 10;

export default function gestureEvents(element) {
  let startPosition;

  utils.addEventListener(element, 'touchstart', (event) => {
    startPosition = event.changedTouches[0].clientX;
  });

  utils.addEventListener(element, 'touchend', (event) => {
    const endPosition = event.changedTouches[0].clientX;
    const distance = endPosition - startPosition;
    const direction = distance < 0 ? 'left' : 'right';

    if (Math.abs(distance) > GESTURE_THRESHOLD) {
      triggerSwipeEvent(element, direction);
    }
  });
}

function triggerSwipeEvent(element, direction) {
  const event = new CustomEvent('swipe', {
    detail: direction,
    bubbles: true,
  });

  element.dispatchEvent(event);
}
